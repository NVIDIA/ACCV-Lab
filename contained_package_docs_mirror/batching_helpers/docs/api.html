

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; ACCV-Lab 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=9282052d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Example" href="example.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ACCV-Lab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../project_overview/README.html">ACCV-Lab Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides_index.html">Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contained Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../on_demand_video_decoder/docs/index.html">On Demand Video Decoder</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Batching Helpers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch"><code class="docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.FromOversizeTensor"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.FromOversizeTensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.Empty"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.Empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.FromFullTensor"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.FromFullTensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.tensor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.sample_sizes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.non_uniform_dim"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.non_uniform_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.num_batch_dims"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.num_batch_dims</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.batch_shape"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.batch_shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.total_num_samples_in_batch"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.total_num_samples_in_batch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.total_num_entries"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.total_num_entries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.max_sample_size"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.max_sample_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.as_self_with_cloned_data"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.as_self_with_cloned_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.create_with_sample_sizes_like_self"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.create_with_sample_sizes_like_self()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.get_non_uniform_dimension_transposed_to"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.get_non_uniform_dimension_transposed_to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.get_existence_weights"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.get_existence_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.with_padded_set_to"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.with_padded_set_to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.set_padded_to"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.set_padded_to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.repeat_samples"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.repeat_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_batch_dim"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.unsqueeze_batch_dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.squeeze_batch_dim"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.squeeze_batch_dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.reshape_batch_dims"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.reshape_batch_dims()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.flatten_batch_dims"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.flatten_batch_dims()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims_to_shape"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.broadcast_batch_dims_to_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.broadcast_batch_dims()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.to_device"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.to_device()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.cpu"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.cpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.to_dtype"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.to_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.detach"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.detach()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.apply"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.set_tensor"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.set_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.split"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_data_dim"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.unsqueeze_data_dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.__getitem__"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.__setitem__"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.__setitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.device"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.shape"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.dtype"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.requires_grad"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.requires_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.retain_grad"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.retain_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.retains_grad"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.retains_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.size"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.dim"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.long"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.long()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.bool"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.bool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.half"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.half()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.bfloat16"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.bfloat16()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.float"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.float()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.double"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.double()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.cfloat"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.cfloat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.cdouble"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.cdouble()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.to"><code class="docutils literal notranslate"><span class="pre">RaggedBatch.to()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.apply_mask_to_tensor"><code class="docutils literal notranslate"><span class="pre">apply_mask_to_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.average_over_targets"><code class="docutils literal notranslate"><span class="pre">average_over_targets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing"><code class="docutils literal notranslate"><span class="pre">batched_bool_indexing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing_write"><code class="docutils literal notranslate"><span class="pre">batched_bool_indexing_write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_index_mapping"><code class="docutils literal notranslate"><span class="pre">batched_index_mapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_indexing_access"><code class="docutils literal notranslate"><span class="pre">batched_indexing_access()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_indexing_write"><code class="docutils literal notranslate"><span class="pre">batched_indexing_write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.batched_inverse_indexing_access"><code class="docutils literal notranslate"><span class="pre">batched_inverse_indexing_access()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.combine_data"><code class="docutils literal notranslate"><span class="pre">combine_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.get_compact_from_named_tuple"><code class="docutils literal notranslate"><span class="pre">get_compact_from_named_tuple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.get_compact_lists"><code class="docutils literal notranslate"><span class="pre">get_compact_lists()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.get_indices_from_mask"><code class="docutils literal notranslate"><span class="pre">get_indices_from_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.get_mask_from_indices"><code class="docutils literal notranslate"><span class="pre">get_mask_from_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.squeeze_except_batch_and_sample"><code class="docutils literal notranslate"><span class="pre">squeeze_except_batch_and_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accvlab.batching_helpers.sum_over_targets"><code class="docutils literal notranslate"><span class="pre">sum_over_targets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dali_pipeline_framework/docs/index.html">DALI Pipeline Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../draw_heatmap/docs/index.html">Draw Heatmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim_test_tools/docs/index.html">Optimization Testing Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ACCV-Lab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Batching Helpers</a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/contained_package_docs_mirror/batching_helpers/docs/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <nav class="contents" id="api" role="doc-toc">
<p class="topic-title">API</p>
<ul class="simple">
<li><p><a class="reference internal" href="#module-accvlab.batching_helpers" id="id1">API Reference</a></p></li>
</ul>
</nav>
<section id="module-accvlab.batching_helpers">
<span id="api-reference"></span><h1><a class="toc-backref" href="#id1" role="doc-backlink">API Reference</a><a class="headerlink" href="#module-accvlab.batching_helpers" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">RaggedBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_uniform_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch" title="Link to this definition"></a></dt>
<dd><p>Class for representing batches with samples with variable size in one dimension.</p>
<dl class="simple">
<dt>The representation of the batch contains 3 tensors:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>tensor:</dt><dd><p>This is the actual data. It has the size of the largest sample
in the non-uniform dimension, and the other samples are padded on the “right” (i.e.
at the end containing larger indices) with filler values to match the size of the largest sample.
While the padding is typically initialized with 0, no values should be assumed for the
padded region as the values there may change after operations are performed on the
data. If the non-uniform dimension is <cite>dim==num_batch_dims</cite>, the shape is
(*batch_dims_shape, max_sample_size, *data_shape). More generally, the first dimensions are the
batch dimensions (one or more). The non-uniform dimension can be any dimension after the batch dimensions
and the size of the non-uniform dimension always corresponds to the maximum sample
size in the batch. The remaining dimensions correspond to the shape of the data, which can have
any number of dimensions, including 0 (per-object scalar data).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mask:</dt><dd><p>This is the mask indicating which elements are valid (<cite>True</cite>) and which are
not (<cite>False</cite>). It has dimensions: (*batch_dims_shape, max_sample_size).
The dimension after the batch dimensions corresponds to the non-uniform dimension in the data
tensor.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sample_sizes:</dt><dd><p>Sizes of the individual samples, i.e. the actual sizes without padding along the
non-uniform dimension.
Shape: (*batch_dims_shape,)</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Additional attributes describing the batch:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>non_uniform_dim:</dt><dd><p>Indicates which dimension is the non-uniform dimension</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>num_batch_dims:</dt><dd><p>Number of batch dimensions at the beginning of the tensor</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tensors described above correspond to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a>, and <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a>
attributes, respectively. The non-uniform dimension can be accessed as <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.non_uniform_dim" title="accvlab.batching_helpers.RaggedBatch.non_uniform_dim"><code class="xref py py-attr docutils literal notranslate"><span class="pre">non_uniform_dim</span></code></a> and the
number of batch dimensions as <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.num_batch_dims" title="accvlab.batching_helpers.RaggedBatch.num_batch_dims"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_batch_dims</span></code></a>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> and <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.non_uniform_dim" title="accvlab.batching_helpers.RaggedBatch.non_uniform_dim"><code class="xref py py-attr docutils literal notranslate"><span class="pre">non_uniform_dim</span></code></a> attributes may be shared between instances of
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances with different data tensors, so they should be treated as
constants and never be changed in-place.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>Here, we show an example of a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance.</p>
<dl class="simple">
<dt>In the image::</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are valid (i.e. correspond to the actual data).</p></li>
<li><p>‘*’ indicates padded filler entries (i.e. invalid entries) in the data.</p></li>
</ul>
</dd>
</dl>
<img alt="Example of a RaggedBatch" class="align-center" src="../../../_images/RaggedBatchExample.png" />
<dl class="simple">
<dt>Note that:</dt><dd><ul class="simple">
<li><p>The example shows a single batch dimension of size 4. More batch and data dimensions are supported.</p></li>
<li><p>The maximum sample size (i.e. the size of the non-uniform dimension) is 3.</p></li>
<li><p>Each element in <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.tensor</span></code> may represent a single value (corresponding to scalar data and 0 data dimensions),
or itself represent a non-scalar entry (in case for one or more data dimensions).</p></li>
<li><p>Even if more data dimensions are present, the <cite>mask</cite> has always <cite>num_batch_dims + 1</cite> dimensions, as the data dimensions
are not needed in the mask.</p></li>
<li><p>The <cite>sample_sizes</cite> have the same shape as the batch dimensions (i.e. <cite>(4,)</cite> in this example), as they contain one value per sample.</p></li>
<li><p>The <cite>sample_sizes</cite> and <cite>mask</cite> contain the same information. However</p>
<ul>
<li><p>Dependent on the use case, one of them may be more efficient &amp; convenient to use</p></li>
<li><p>One can be efficiently computed from the other (as is done as needed in the <cite>RaggedBatch</cite> implementation).</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of batch dimensions is determined from the shape of the provided <cite>mask</cite> or <cite>sample_sizes</cite> tensor.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If both <cite>mask</cite> and <cite>sample_sizes</cite> are set, they need to be consistent with each other. This is
not checked in the constructor. Inconsistent masks and sample sizes will lead to undefined behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Data to be stored (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above)</p></li>
<li><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Mask indicating which entries are valid (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above).
If not set, <cite>sample_sizes</cite> is internally used to create a mask.
Note that at least one of <cite>mask</cite> or <cite>sample_sizes</cite> needs to be set.</p></li>
<li><p><strong>sample_sizes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Number of valid entries for all samples (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above).
If not set, <cite>mask</cite> is internally used to create a sample sizes tensor.
Note that at least one of <cite>mask</cite> or <cite>sample_sizes</cite> needs to be set.</p></li>
<li><p><strong>non_uniform_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Dimension in which the batch is non-uniform, default: 1</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.FromOversizeTensor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FromOversizeTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_uniform_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.FromOversizeTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.FromOversizeTensor" title="Link to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance from a tensor which is over-sized in the non-uniform dimension.</p>
<p>Over-sized means that the non-uniform dimension is larger than the maximum sample size in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Data to be stored (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above) except that the
non-uniform dimension is larger than the maximum sample size in the batch.
The tensor in the is truncated to the maximum sample size in the batch.</p></li>
<li><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Mask indicating which entries are valid (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above).
If not set, <cite>sample_sizes</cite> is internally used to create a mask.
Note that at least one of <cite>mask</cite> or <cite>sample_sizes</cite> needs to be set. The mask is truncated to the maximum sample size in the batch.</p></li>
<li><p><strong>sample_sizes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Number of valid entries for all samples (corresponding to the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> tensor of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see description above).
If not set, <cite>mask</cite> is internally used to create a sample sizes tensor.
Note that at least one of <cite>mask</cite> or <cite>sample_sizes</cite> needs to be set.</p></li>
<li><p><strong>non_uniform_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Dimension in which the batch is non-uniform, default: 1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of batch dimensions is determined from the shape of the provided <cite>mask</cite> or <cite>sample_sizes</cite> tensor.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If both <cite>mask</cite> and <cite>sample_sizes</cite> are set, they need to be consistent with each other. This is
not checked in the constructor. Inconsistent masks and sample sizes will lead to undefined behavior.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.Empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_uniform_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.Empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.Empty" title="Link to this definition"></a></dt>
<dd><p>Create an empty instance.</p>
<p>The so created instance has a size of 0 along all dimensions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If neither <cite>num_batch_dims</cite> nor <cite>batch_shape</cite> is provided, the number of batch dimensions is 1 and the batch shape is (0,).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dims</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Total number of dimensions</p></li>
<li><p><strong>non_uniform_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The non-uniform dimension</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Device to use for the instance</p></li>
<li><p><strong>num_batch_dims</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Number of batch dimensions. If provided, <cite>batch_shape</cite> cannot be set and size 0 is
assumed for all batch dimensions.</p></li>
<li><p><strong>batch_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Shape of the batch (can be a sequence of ints or a single int in case of a single batch dimension).
If not provided, the batch shape is (0,) * num_batch_dims. If provided, <cite>num_batch_dims</cite> cannot be set
and the number of batch dimensions is inferred from the shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – The resulting empty <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.FromFullTensor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FromFullTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_uniform_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.FromFullTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.FromFullTensor" title="Link to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance from a tensor representing a uniform-sized batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Tensor to convert into a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance</p></li>
<li><p><strong>non_uniform_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Dimension to use as the non-uniform dimension.
Note that while in this special case, all dimensions are uniform,
the non-uniform dimension has a special meaning
(e.g. for <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.get_non_uniform_dimension_transposed_to" title="accvlab.batching_helpers.RaggedBatch.get_non_uniform_dimension_transposed_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_non_uniform_dimension_transposed_to()</span></code></a>, and many other functions) and
needs to be set.</p></li>
<li><p><strong>num_batch_dims</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of batch dimensions in the tensor. Default: 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – The resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance containing the input tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.tensor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tensor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="Link to this definition"></a></dt>
<dd><p>Get the data tensor</p>
<p>See the description of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> for more information on <cite>tensor</cite>.</p>
<p>For setting the data tensor, use <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.set_tensor" title="accvlab.batching_helpers.RaggedBatch.set_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_tensor()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.mask" title="Link to this definition"></a></dt>
<dd><p>Get the mask tensor</p>
<p>See the description of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> for more information on <cite>mask</cite>.</p>
<p>The mask indicates which elements are valid (<cite>True</cite>) and which are not (<cite>False</cite>).
It has dimensions: <code class="docutils literal notranslate"><span class="pre">(*batch_dims_shape,</span> <span class="pre">max_sample_size)</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.sample_sizes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_sizes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="Link to this definition"></a></dt>
<dd><p>Get the sample sizes tensor</p>
<p>See the description of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> for more information on <cite>sample_sizes</cite>.</p>
<p>The sample sizes tensor contains the actual sizes of each sample in the batch
along the non-uniform dimension.
Its dimensions are <code class="docutils literal notranslate"><span class="pre">batch_dims_shape</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.non_uniform_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">non_uniform_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.non_uniform_dim" title="Link to this definition"></a></dt>
<dd><p>Get the non-uniform dimension</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.num_batch_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_batch_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.num_batch_dims" title="Link to this definition"></a></dt>
<dd><p>Get the number of batch dimensions</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.batch_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><span class="pre">Size</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.batch_shape" title="Link to this definition"></a></dt>
<dd><p>Get the batch shape</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.total_num_samples_in_batch">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_num_samples_in_batch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.total_num_samples_in_batch" title="Link to this definition"></a></dt>
<dd><p>Get the total number of samples in the batch</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.total_num_entries">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_num_entries</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.total_num_entries" title="Link to this definition"></a></dt>
<dd><p>Get the total number of entries.</p>
<p>This is the accumulated number of valid entries along the non-uniform dimension over all samples in the batch.
This information is computed from the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> tensor when it is first accessed and re-used on subsequent calls.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.max_sample_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_sample_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.max_sample_size" title="Link to this definition"></a></dt>
<dd><p>Get the maximum sample size in the batch</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.as_self_with_cloned_data">
<span class="sig-name descname"><span class="pre">as_self_with_cloned_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.as_self_with_cloned_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.as_self_with_cloned_data" title="Link to this definition"></a></dt>
<dd><p>Create a copy, where the data tensor (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>) is cloned (while mask and sample sizes are shared)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.create_with_sample_sizes_like_self">
<span class="sig-name descname"><span class="pre">create_with_sample_sizes_like_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_uniform_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.create_with_sample_sizes_like_self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.create_with_sample_sizes_like_self" title="Link to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the same batch shape and sample sizes as <cite>this</cite></p>
<p>Note that while the sample sizes are the same, the total number of dimensions,
the non-uniform dimension, and the size of the <cite>data</cite> tensor except in the
batch and the non-uniform dimensions may be different.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Data to set for the new instance (padded tensor)</p></li>
<li><p><strong>non_uniform_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Non-uniform dimension (in <cite>tensor</cite>). Can be set to <cite>None</cite> to use the same
dimension as <cite>this</cite>. Default: <cite>None</cite></p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Device on which to create the resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance. If not provided,
the device of the input <cite>tensor</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the same batch shape and sample sizes as <cite>this</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.get_non_uniform_dimension_transposed_to">
<span class="sig-name descname"><span class="pre">get_non_uniform_dimension_transposed_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.get_non_uniform_dimension_transposed_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.get_non_uniform_dimension_transposed_to" title="Link to this definition"></a></dt>
<dd><p>Get with the non-uniform dimension transposed to a given dimension.</p>
<p>If the given dimension is already the non-uniform dimension, <cite>self</cite> is returned.</p>
<dl class="simple">
<dt>Info:</dt><dd><p>The non-uniform dimension cannot be set to a batch dimension (i.e., any dimension &lt; num_batch_dims).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Dimension to transpose the current non-uniform dimension to</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.get_existence_weights">
<span class="sig-name descname"><span class="pre">get_existence_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.get_existence_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.get_existence_weights" title="Link to this definition"></a></dt>
<dd><p>Get the existence weights</p>
<p>The existence weights are 1.0 for the contained entries (i.e. entries corresponding to actual
data as opposed to padded fillers)  and 0.0 for filler entries.</p>
<p>In contrast to <cite>self.mask</cite>, the dimensionality and shape of the weights
correspond to the dimensionality and shape of the data. This means that the mask
can be directly applied to the data tensor (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>), regardless of the number of dimensions or
which dimension is the non-uniform dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dtype</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code>) – Type for the existence weights. Default: torch.float32</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span> – The resulting weights tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.with_padded_set_to">
<span class="sig-name descname"><span class="pre">with_padded_set_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_to_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.with_padded_set_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.with_padded_set_to" title="Link to this definition"></a></dt>
<dd><p>Set filler/padded entries in the data (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>) to a fixed value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is not performed in-place, i.e. <cite>this.tensor</cite> is not changed. For an in-place
operation, use <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.set_padded_to" title="accvlab.batching_helpers.RaggedBatch.set_padded_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_padded_to()</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value_to_set</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.float" title="accvlab.batching_helpers.RaggedBatch.float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Value to set for padded entries.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Like self, but with the padded values set</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.set_padded_to">
<span class="sig-name descname"><span class="pre">set_padded_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_to_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.set_padded_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.set_padded_to" title="Link to this definition"></a></dt>
<dd><p>Set filler/padded entries in the data tensor (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>) to a fixed value in-place.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that as this operation is in-place. This means that <cite>this.tensor</cite> is changed.
No new <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance is created. If this is not desired, use
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.with_padded_set_to" title="accvlab.batching_helpers.RaggedBatch.with_padded_set_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_padded_set_to()</span></code></a> instead, which is not in-place and returns a new <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value_to_set</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.float" title="accvlab.batching_helpers.RaggedBatch.float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Value to set for padded entries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.repeat_samples">
<span class="sig-name descname"><span class="pre">repeat_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_repeats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.repeat_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.repeat_samples" title="Link to this definition"></a></dt>
<dd><p>Repeat along a single batch dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – Number of times to repeat. In case of a single value, the dimension in which to repeat
is specified by <cite>batch_dim</cite>. In case of a sequence, the sequence needs to have the same length as
the number of batch dimensions and <cite>batch dim</cite> must not be set.</p></li>
<li><p><strong>batch_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Which batch dimension to repeat along. Can only be set if <cite>num_repeats</cite> is a single value.
If not set (and <cite>num_repeats</cite> is a single value), <cite>0</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the samples repeated</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.unsqueeze_batch_dim">
<span class="sig-name descname"><span class="pre">unsqueeze_batch_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.unsqueeze_batch_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_batch_dim" title="Link to this definition"></a></dt>
<dd><p>Unsqueeze a batch dimension</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The dimension to unsqueeze has to be among the batch dimensions (including adding a new batch dimension
after the currently last batch dimensions, i.e. <cite>dim=self.num_batch_dims</cite>).</p>
<p>For unsqueezing a data dimension, use <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_data_dim" title="accvlab.batching_helpers.RaggedBatch.unsqueeze_data_dim"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unsqueeze_data_dim()</span></code></a> instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the batch dimensions are always before the non-uniform dimension, the non-uniform dimension is shifted by 1 accordingly.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">num_batch_dims</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_unsqueezed</span> <span class="o">=</span> <span class="n">example_batch</span><span class="o">.</span><span class="n">unsqueeze_batch_dim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_unsqueezed</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">5</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Batch dimension to add. Has to be in range [0, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.num_batch_dims" title="accvlab.batching_helpers.RaggedBatch.num_batch_dims"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_batch_dims</span></code></a>].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the batch dimension added</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.squeeze_batch_dim">
<span class="sig-name descname"><span class="pre">squeeze_batch_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.squeeze_batch_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.squeeze_batch_dim" title="Link to this definition"></a></dt>
<dd><p>Squeeze a batch dimension</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is not performed in-place, i.e. <cite>this.tensor</cite> is not changed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Batch dimension to squeeze. Has to be in range [0, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.num_batch_dims" title="accvlab.batching_helpers.RaggedBatch.num_batch_dims"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_batch_dims</span></code></a>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the batch dimension squeezed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.reshape_batch_dims">
<span class="sig-name descname"><span class="pre">reshape_batch_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_batch_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.reshape_batch_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.reshape_batch_dims" title="Link to this definition"></a></dt>
<dd><p>Reshape the batch dimensions</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is not performed in-place, i.e. <cite>this.tensor</cite> is not changed.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The non-uniform dimension is adjusted to the new batch shape.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_batch_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]</span>) – New batch shape</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the batch dimensions reshaped</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.flatten_batch_dims">
<span class="sig-name descname"><span class="pre">flatten_batch_dims</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.flatten_batch_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.flatten_batch_dims" title="Link to this definition"></a></dt>
<dd><p>Flatten the batch dimensions
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is not performed in-place, i.e. <cite>this.tensor</cite> is not changed.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims_to_shape">
<span class="sig-name descname"><span class="pre">broadcast_batch_dims_to_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_batch_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.broadcast_batch_dims_to_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims_to_shape" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">broadcast_batch_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.broadcast_batch_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.broadcast_batch_dims" title="Link to this definition"></a></dt>
<dd><p>Broadcast the batch dimensions of a sequence of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances to common batch dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>) – Sequence of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span> – Sequence of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances with the batch dimensions broadcasted to the common batch dimensions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.to_device">
<span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.to_device" title="Link to this definition"></a></dt>
<dd><p>Get on device</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.cpu" title="Link to this definition"></a></dt>
<dd><p>Get on the CPU</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.to_dtype">
<span class="sig-name descname"><span class="pre">to_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.to_dtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.to_dtype" title="Link to this definition"></a></dt>
<dd><p>Get with <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> converted to given data type</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.detach" title="Link to this definition"></a></dt>
<dd><p>Get with detached <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proc_step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.apply" title="Link to this definition"></a></dt>
<dd><p>Apply a function to <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> and get results as new <cite>RaggedBatch</cite> instance(s).</p>
<p>See the <cite>proc_step</cite> parameter for requirements for the used function.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is important to make sure that the tensors returned by <cite>proc_step</cite> fulfill the output requirements
regarding the non-uniform dimension, sample sizes, and regarding the valid entries being stored first (i.e. lower indices),
followed by filler values along the non-uniform dimension to ensure that the resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances are correct.
See the <cite>proc_step</cite> parameter for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>proc_step</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]]]</span>) – <p>Function to process the data tensor. All the defined inputs (see below) are
expected to be positional arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">param tensor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Will contain <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> of <cite>this</cite></p>
</dd>
<dt class="field-even">param mask<span class="colon">:</span></dt>
<dd class="field-even"><p>If part of the function signature, will contain <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> of <cite>this</cite></p>
</dd>
<dt class="field-odd">param sample_sizes<span class="colon">:</span></dt>
<dd class="field-odd"><p>As a positional argument, this can only be part of the function
signature if <cite>mask</cite> is. If used, will contain <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> of <cite>this</cite></p>
</dd>
<dt class="field-even">returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either a tensor or a tuple of tensors. For each tensor, a
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance will be output from <cite>apply()</cite>. Note that for each
returned tensor, the non-uniform dimension, as well as the number of entries along
that dimension, must correspond to <cite>this</cite>. Also, for each sample, the the valid
entries must be located before any filler entries along the non-uniform dimension (as is in general the case for
the data stored in a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, see documentation of the class). Note that the last
point is generally fulfilled if no permutations are applied to the data tensor, as the input <cite>tensor</cite>
contains valid entries first, followed by filler entries.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]</span> – <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance or tuple of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances (depending on the output of <cite>proc_step</cite>),
with the function applied to the data (i.e. to <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.set_tensor">
<span class="sig-name descname"><span class="pre">set_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.set_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.set_tensor" title="Link to this definition"></a></dt>
<dd><p>Set <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The batch shape, the non-uniform dimension, and the number of entries along
that dimension must correspond to <cite>this</cite>. Also, for each sample, the valid
entries must be located before any filler entries (as is in general the case for
the data stored in a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance, see documentation of the class).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Data tensor to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.split" title="Link to this definition"></a></dt>
<dd><p>Split contained data (i.e. the data in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>) into individual samples.</p>
<p>The batch dimensions are preserved in the nested list structure.
For example, if the batch shape is (2, 3), the result will be a list of 2 lists,
each containing 3 tensors.</p>
<p>The returned samples are cropped to not contain any filler entries. This means that the
returned tensors correspond to the actual sample sizes.</p>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>In the example below, the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.split" title="accvlab.batching_helpers.RaggedBatch.split"><code class="xref py py-meth docutils literal notranslate"><span class="pre">split()</span></code></a> operation is applied to a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with
a batch size of 4 (single batch dimension) and a maximum sample size of 3, resulting in a list
of 4 tensors, and each tensor corresponding to a single sample without padded filler entries.
Note that in the image below:</p>
<blockquote>
<div><ul class="simple">
<li><p>Letters indicate data entries that are valid (i.e. correspond to the actual data).</p></li>
<li><p>‘*’ Indicates padded filler entries (i.e. invalid entries) in the data.</p></li>
</ul>
</div></blockquote>
<img alt="Illustration of the split operation" class="align-center" src="../../../_images/Split_ragged.png" />
<p>Each depicted element may represent a single value (corresponding to scalar data and 0 data dimensions),
or itself represent a non-scalar entry (in case for one or more data dimensions).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]]</span> – The individual samples in a nested list structure that reflects the original batch shape.
The individual tensors correspond to the actual sample sizes, and do not contain padded filler entries.</p>
<p>For a single batch dimension, returns a flat list of tensors.
For multiple batch dimensions, returns a nested list structure mirroring the batch dimensions.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.unsqueeze_data_dim">
<span class="sig-name descname"><span class="pre">unsqueeze_data_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.unsqueeze_data_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_data_dim" title="Link to this definition"></a></dt>
<dd><p>Unsqueeze the data tensor (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>) along a dimension.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The dimension to unsqueeze has to be after the batch dimensions (including adding a new data dimension
right after the batch dimensions, i.e. <cite>dim=self.num_batch_dims</cite>).</p>
<p>For unsqueezing a batch dimension, use <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.unsqueeze_batch_dim" title="accvlab.batching_helpers.RaggedBatch.unsqueeze_batch_dim"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unsqueeze_batch_dim()</span></code></a> instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the new dimension is inserted before the current non-uniform dimension, the
non-uniform dimension is shifted by 1 accordingly.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">num_batch_dims</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_unsqueezed</span> <span class="o">=</span> <span class="n">example_batch</span><span class="o">.</span><span class="n">unsqueeze_data_dim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_unsqueezed</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Dimension index into which to insert the new dimension</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Like self, but with the new dimension added, and the non-uniform
dimension shifted accordingly if needed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Item read access for <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p>
<p>This is a shorthand for: <cite>… = self.tensor[item]</cite>.</p>
<p>Note than as such, this allows for access to filler entries and does not check whether the accessed
elements correspond to valid or filler entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.__setitem__" title="Link to this definition"></a></dt>
<dd><p>Item write access for <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p>
<p>This is a shorthand for: <cite>self.tensor[item] = …</cite>.</p>
<p>Note than as such, this allows for access to filler entries and does not check whether the accessed
elements correspond to valid or filler entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.device" title="Link to this definition"></a></dt>
<dd><p>Get the used device</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><span class="pre">Size</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.shape" title="Link to this definition"></a></dt>
<dd><p>Get the shape of the data tensor (i.e. <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>)</p>
<p>The non-uniform dimension is reported as the size of the underlying <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>,
i.e. to the maximum size among all samples.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">dtype</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.dtype" title="Link to this definition"></a></dt>
<dd><p>Type of the data elements (i.e. elements of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.requires_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requires_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.requires_grad" title="Link to this definition"></a></dt>
<dd><p>Get/set whether <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> requires gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.retain_grad">
<span class="sig-name descname"><span class="pre">retain_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.retain_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.retain_grad" title="Link to this definition"></a></dt>
<dd><p>Retain gradients for <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.retains_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retains_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.retains_grad" title="Link to this definition"></a></dt>
<dd><p>Get whether gradients are retained for <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.size" title="Link to this definition"></a></dt>
<dd><p>Shorthand for <cite>self.tensor.size(*args, **kwargs)</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.dim" title="Link to this definition"></a></dt>
<dd><p>Get the number of dimensions (of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.int" title="accvlab.batching_helpers.RaggedBatch.int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.int">
<span class="sig-name descname"><span class="pre">int</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.int" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.long">
<span class="sig-name descname"><span class="pre">long</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.long"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.long" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.bool">
<span class="sig-name descname"><span class="pre">bool</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.bool" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.half">
<span class="sig-name descname"><span class="pre">half</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.half"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.half" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.bfloat16">
<span class="sig-name descname"><span class="pre">bfloat16</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.bfloat16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.bfloat16" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.float">
<span class="sig-name descname"><span class="pre">float</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.float" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.double">
<span class="sig-name descname"><span class="pre">double</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.double"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.double" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.cfloat">
<span class="sig-name descname"><span class="pre">cfloat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.cfloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.cfloat" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.cdouble">
<span class="sig-name descname"><span class="pre">cdouble</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.cdouble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.cdouble" title="Link to this definition"></a></dt>
<dd><p>Convert type of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> elements</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="accvlab.batching_helpers.RaggedBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/data_format/ragged_batch.html#RaggedBatch.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.RaggedBatch.to" title="Link to this definition"></a></dt>
<dd><p>Create a new <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance converted as specified.</p>
<p>This is a shorthand for:
<cite>self.create_with_sample_sizes_like_self(self._tensor.to(*args, **kwargs))</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The conversion is primarily performed on the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>.
The <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> and <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> are adjusted accordingly if needed
(e.g. when converting to a different device, but not when converting to a different
dtype, as the dtype is only relevant for the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a>).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Arguments for <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.Tensor.to.html#torch.Tensor.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.to()</span></code></a> as applied to <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments for <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.Tensor.to.html#torch.Tensor.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.to()</span></code></a> as applied to <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – A new <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance with the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.tensor" title="accvlab.batching_helpers.RaggedBatch.tensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code></a> converted to the given type
and the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.sample_sizes" title="accvlab.batching_helpers.RaggedBatch.sample_sizes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sample_sizes</span></code></a> and <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch.mask" title="accvlab.batching_helpers.RaggedBatch.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mask</span></code></a> adjusted accordingly if needed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.apply_mask_to_tensor">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">apply_mask_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#apply_mask_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.apply_mask_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Apply mask to tensor</p>
<p>Apply a mask to a tensor, setting any elements in the tensor corresponding to <code class="docutils literal notranslate"><span class="pre">False</span></code> entries in the mask
to a fixed value. The mask may have fewer dimensions than the data. In this case, it is assumed to be constant in the
remaining dimensions and the available dimensions correspond to the outer data dimensions (i.e. starting from <code class="docutils literal notranslate"><span class="pre">dim==0</span></code>
in the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Data to apply mask to</p></li>
<li><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Mask to apply</p></li>
<li><p><strong>value_to_set</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – Value to set for padded entries. Default is 0.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span> – Like <code class="docutils literal notranslate"><span class="pre">data</span></code>, but with the mask applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.average_over_targets">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">average_over_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans_to_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#average_over_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.average_over_targets" title="Link to this definition"></a></dt>
<dd><p>Average along the non-uniform dimension, considering only the valid entries.</p>
<p>The dimension to average over is <code class="docutils literal notranslate"><span class="pre">data.non_uniform_dim</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – Data to average</p></li>
<li><p><strong>nans_to_zero</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to replace NaNs with zeros after averaging. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span> – Tensor containing per-sample averages</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_bool_indexing">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_bool_indexing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_bool_indexing.html#batched_bool_indexing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_bool_indexing" title="Link to this definition"></a></dt>
<dd><p>Batched boolean indexing.</p>
<p>This function performs batched boolean indexing on the input data using the input mask.
Both the input data and the input mask can be either <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> or <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>
instances.</p>
<p>The indexing is performed along the non-uniform dimension of the input data. For tensors,
the non-uniform dimension is assumed to be <code class="docutils literal notranslate"><span class="pre">dim==1</span></code>.</p>
<p>In case that one <code class="docutils literal notranslate"><span class="pre">input_data</span></code> or <code class="docutils literal notranslate"><span class="pre">input_mask</span></code> is a <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> and the other is
a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>A single batch dimension must be used</p></li>
<li><p>The sample sizes of the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> are assumed to also apply to the tensor</p></li>
<li><p>The non-uniform dimension of the tensor is assumed to be <code class="docutils literal notranslate"><span class="pre">dim==1</span></code></p></li>
</ul>
</div></blockquote>
<p>If both the input data and the input mask are tensors:</p>
<blockquote>
<div><ul class="simple">
<li><p>All entries along <code class="docutils literal notranslate"><span class="pre">dim==1</span></code> (the non-uniform dimension) are assumed to be valid (i.e. sample size for
each sample corresponds to the size of this dimension)</p></li>
<li><p>The output will also be a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> in this case (as in general, the number of <code class="docutils literal notranslate"><span class="pre">True</span></code>
values in the mask is not the same for all samples)</p>
<ul>
<li><p>A single batch dimension will be used (consistent to the assumption about the input data)</p></li>
<li><p>The non-uniform dimension will be at <code class="docutils literal notranslate"><span class="pre">dim==1</span></code> (consistent to the assumption about the input data)</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>If both the input data and the input mask are <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances, multiple batch dimensions
are supported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If both the input data and mask are <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances, it is assumed that the sample
sizes match. Only the maximum sample size is checked and if the individual sample sizes are not the
same, the behavior is undefined.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The data to index into.
Shape (in case of the non-uniform dimension being <code class="docutils literal notranslate"><span class="pre">dim==1</span></code>):
<code class="docutils literal notranslate"><span class="pre">(*batch_shape,</span> <span class="pre">max_sample_size,</span> <span class="pre">*data_shape)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">max_sample_size</span></code> is the maximum sample size of the input data.
Note that the data_shape may contain 0 or more entries.
If the non-uniform dimension is not <code class="docutils literal notranslate"><span class="pre">dim==1</span></code>, the <code class="docutils literal notranslate"><span class="pre">max_sample_size</span></code> is also not the size of the
second dimension (<code class="docutils literal notranslate"><span class="pre">dim==1</span></code>), but of the corresponding dimension.</p></li>
<li><p><strong>input_mask</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The mask to use for indexing.
Shape: <code class="docutils literal notranslate"><span class="pre">(*batch_shape,</span> <span class="pre">max_sample_size)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">max_sample_size</span></code> is the maximum sample size of the input data.
Note that <code class="docutils literal notranslate"><span class="pre">data_shape</span></code> is not present, as each data entry is treated as a single element
in the indexing operation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance containing the indexed data for each sample.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘-’ indicates entries where the actual values are not relevant (in the input).</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
</ul>
</dd>
</dl>
<img alt="Illustration of the batched boolean indexing operation" class="align-center" src="../../../_images/BatchedBoolIndexAccess_ragged.png" />
<p>Each depicted entry in <code class="docutils literal notranslate"><span class="pre">input_data</span></code> may represent a single value (in case of
2D tensors), or itself be a non-scalar entry (in case that <code class="docutils literal notranslate"><span class="pre">input_data</span></code> has more than 2 dimensions).
The entries in <code class="docutils literal notranslate"><span class="pre">input_mask</span></code> are always scalar.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_bool_indexing_write">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_bool_indexing_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_write</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_write_into</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_bool_indexing.html#batched_bool_indexing_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_bool_indexing_write" title="Link to this definition"></a></dt>
<dd><p>Batched boolean indexing write (inverse operation of batched_bool_indexing).</p>
<p>This function performs the inverse operation of <a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing" title="accvlab.batching_helpers.batched_bool_indexing"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_bool_indexing()</span></code></a>. It writes data from a
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> into a target tensor or <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> using a boolean mask to specify
where to write the data.</p>
<p>The writing is performed along the non-uniform dimension of <cite>to_write_into</cite>. For tensors,
the non-uniform dimension is assumed to be <cite>dim==1</cite>.</p>
<p>In case that one <cite>output_mask</cite> or <cite>to_write_into</cite> is a <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> and the other is a
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>A single batch dimension must be used</p></li>
<li><p>The sample sizes of the <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> are assumed to also apply to the tensor (regardless of
which of the two is which)</p></li>
<li><p>The non-uniform dimension of the tensor is assumed to be <cite>dim==1</cite></p></li>
</ul>
</div></blockquote>
<p>If both <cite>output_mask</cite> and <cite>to_write_into</cite> are tensors, all entries along <cite>dim==1</cite> (the non-uniform
dimension) are assumed to be valid (i.e. sample size for each sample corresponds to the size of this
dimension).</p>
<p>Multiple batch dimensions are only supported if both <cite>output_mask</cite> and <cite>to_write_into</cite> are
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If both <cite>output_mask</cite> and <cite>to_write_into</cite> are <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances, it is assumed that
the sample sizes match. Only the maximum sample size is checked and if the individual sample sizes are
not the same, the behavior is undefined.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_write</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – The <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> containing the data to write.
Shape (in case of the non-uniform dimension being <cite>dim==1</cite>):
<cite>(*batch_shape, max_sample_size, *data_shape)</cite>,
where <cite>max_sample_size</cite> is the maximum sample size of the data to write.
Note that the data_shape may contain 0 or more entries.
If the non-uniform dimension is not <cite>dim==1</cite>, the <cite>max_sample_size</cite> is also not the size of the
second dimension (<cite>dim==1</cite>), but of the corresponding dimension.</p></li>
<li><p><strong>output_mask</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The mask specifying where to write the data.
Shape: <cite>(*batch_shape, max_sample_size)</cite>,
Note that <cite>data_shape</cite> is not present, as each data entry is treated as a single element
in the writing operation.</p></li>
<li><p><strong>to_write_into</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The target tensor or <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> to write into.
Shape: <cite>(*batch_shape, max_sample_size, *data_shape)</cite>,
The data_shape must match the data_shape of <cite>to_write</cite>.
If the non-uniform dimension is not <cite>dim==1</cite>, the <cite>max_sample_size</cite> is also not the size of the
second dimension (<cite>dim==1</cite>), but of the corresponding dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span> – <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> or <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> instance containing the target data with the
selected elements from <cite>to_write</cite> written into the positions specified by <cite>output_mask</cite>.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
<li><p>‘..’ indicates data which remains unchanged, i.e. is the same as in the <cite>to_write_into</cite> parameter
and the output.</p></li>
</ul>
</dd>
</dl>
<img alt="Illustration of the batched boolean indexing write operation" class="align-center" src="../../../_images/BatchedBoolIndexWrite_ragged.png" />
<p>Each depicted entry in <cite>to_write</cite> and <cite>to_write_into</cite> may represent a single value (in case of
2D tensors), or itself be a non-scalar entry (in case that the data has more than 2 dimensions).
The entries in <cite>output_mask</cite> are always scalar.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_index_mapping">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_index_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_index_mapping_op.html#batched_index_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_index_mapping" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Map values between <code class="docutils literal notranslate"><span class="pre">source_data</span></code> and <code class="docutils literal notranslate"><span class="pre">target_data</span></code> using a mapping defined by pairs of indices for elements
in <code class="docutils literal notranslate"><span class="pre">source_data</span></code> and <code class="docutils literal notranslate"><span class="pre">target_data</span></code>, and set the corresponding values in <code class="docutils literal notranslate"><span class="pre">target_data</span></code>.</p>
<p>For a sample <code class="docutils literal notranslate"><span class="pre">i</span></code> and a valid index pair <code class="docutils literal notranslate"><span class="pre">j</span></code> (valid means <code class="docutils literal notranslate"><span class="pre">target_indices.sample_sizes[i]</span> <span class="pre">&gt;</span> <span class="pre">j</span></code> and
<code class="docutils literal notranslate"><span class="pre">source_indices.sample_sizes[i]</span> <span class="pre">&gt;</span> <span class="pre">j</span></code>), the operation can be expressed as (assuming non-uniform dimension
<code class="docutils literal notranslate"><span class="pre">dim</span> <span class="pre">==</span> <span class="pre">1</span></code> for both <code class="docutils literal notranslate"><span class="pre">source_data</span></code> and <code class="docutils literal notranslate"><span class="pre">target_data</span></code>):</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">target_data[i,</span> <span class="pre">target_indices[i,</span> <span class="pre">j]]</span> <span class="pre">=</span> <span class="pre">source_data[i,</span> <span class="pre">source_indices[i,</span> <span class="pre">j]]</span></code></p>
</div></blockquote>
<p>This function sets the values in <cite>target_data</cite> in a way which corresponds to the line above
for all valid matches in all samples.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is expected that for each sample, the number of valid indices for the source and target matches,
i.e. <code class="docutils literal notranslate"><span class="pre">target_indices.sample_sizes</span> <span class="pre">==</span> <span class="pre">source_indices.sample_sizes</span></code>.</p>
<p>If this is not the case, the behavior is undefined.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function assumes that for each sample, there are no duplicate indices in
<code class="docutils literal notranslate"><span class="pre">target_indices</span></code>, i.e. there are no duplicates in the valid entries in:
<code class="docutils literal notranslate"><span class="pre">target_indices[i,</span> <span class="pre">0:target_indices.sample_sizes[i]]</span></code>.</p>
<p>If this is not the case, the behavior is undefined.</p>
<p>There are no such restrictions on <cite>source_indices</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>) – <p>Input data.</p>
<dl class="simple">
<dt>Shape in case of a tensor:</dt><dd><p>(batch_size, num_entries_input, …)</p>
</dd>
</dl>
<p>In case of a RaggedBatch, the following holds:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">target_data.shape[0]</span> <span class="pre">==</span> <span class="pre">batch_size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_data.shape[target_data.non_uniform_dim]</span> <span class="pre">==</span> <span class="pre">num_entries_input</span></code></p></li>
</ul>
</div></blockquote>
<p>The number of dimensions needs to correspond to <code class="docutils literal notranslate"><span class="pre">target_data</span></code>, and the shape needs
to be the same except in the non-uniform dimension (<code class="docutils literal notranslate"><span class="pre">dim</span> <span class="pre">==</span> <span class="pre">1</span></code> for tensors), as in
this dimension, the matching is done using the index pairs.</p>
</p></li>
<li><p><strong>source_indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – Indices at which to get the input data. Shape: (batch_size, max_num_matches).
Note that the batch size and sample sizes need to match <code class="docutils literal notranslate"><span class="pre">target_indices</span></code>, i.e.
<code class="docutils literal notranslate"><span class="pre">target_indices.sample_sizes</span> <span class="pre">==</span> <span class="pre">source_indices.sample_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">max_num_matches</span></code>
corresponds to the maximum matches among all samples.</p></li>
<li><p><strong>target_indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – Indices at which to fill the data. Shape: (batch_size, max_num_matches)
Note that <code class="docutils literal notranslate"><span class="pre">max_num_matches</span></code> corresponds to the maximum matches among all samples.</p></li>
<li><p><strong>target_data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>) – <p>Data to fill the values into.</p>
<p>Shape in case of a tensor: (batch_size, num_entries_output, …)</p>
<dl class="simple">
<dt>In case of a RaggedBatch, the following holds:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">target_data.shape[0]</span> <span class="pre">==</span> <span class="pre">batch_size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_data.shape[target_data.non_uniform_dim]</span> <span class="pre">==</span> <span class="pre">num_entries_output</span></code></p></li>
</ul>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span> – As <code class="docutils literal notranslate"><span class="pre">target_data</span></code>, with the values from <code class="docutils literal notranslate"><span class="pre">source_data</span></code> inserted according to the pairs of
corresponding indices in <code class="docutils literal notranslate"><span class="pre">source_indices</span></code> and <code class="docutils literal notranslate"><span class="pre">target_indices</span></code>.</p>
<p>Shape in case of a tensor:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_entries_output,</span> <span class="pre">...)</span></code></p>
</div></blockquote>
<p>In case of a RaggedBatch, the following holds:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">target_data_filled.shape[0]</span> <span class="pre">==</span> <span class="pre">batch_size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_data_filled.shape[target_data_filled.non_uniform_dim]</span> <span class="pre">==</span> <span class="pre">num_entries_output</span></code></p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<ul class="simple">
<li><p>‘-’ indicates values in the input which are not used in the mapping</p></li>
<li><p>‘*’ indicates filler values in <cite>source_indices</cite> and <cite>target_indices</cite>, which are ignored.</p></li>
<li><p>‘..’ indicates data which remains unchanged, i.e. is the same as in the <cite>target_data</cite> parameter
and the output.</p></li>
</ul>
<p>Each depicted element in <cite>source_data</cite> and <cite>target_data</cite> may represent a single value
(in case of 2D tensors), or itself be a non-scalar entry (in case that the data has more than 2 dimensions).</p>
<img alt="Illustration of the mapping operation" class="align-center" src="../../../_images/Mapping_ragged.png" />
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_indexing_access">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_indexing_access</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filler_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_to_index_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_indexing_ops.html#batched_indexing_access"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_indexing_access" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Batched indexing access with non-uniform indices.</p>
<p>Note that for each sample, the number of resulting entries corresponds to the number of indices. This means that in general,
the output size will be non-uniform. Therefore, a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> is returned regardless of the <code class="docutils literal notranslate"><span class="pre">input_data</span></code> type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that whether <code class="docutils literal notranslate"><span class="pre">input_data</span></code> is a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> or a <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, the indexing of <code class="docutils literal notranslate"><span class="pre">input_data</span></code>
is performed along <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code>, which is not necessarily the non-uniform dimension of <code class="docutils literal notranslate"><span class="pre">input_data</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While the <code class="docutils literal notranslate"><span class="pre">filler_value</span></code> parameter can be used to set the value for filler values,
the filler value may change when processing the resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> further. Therefore,
care needs to be taken when assuming a certain filler value.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Data to which the indexing is applied.</p></li>
<li><p><strong>input_indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – For each sample (element along the batch dimension), the indices of entries to obtain from the input.
Shape: <code class="docutils literal notranslate"><span class="pre">(*batch_shape,</span> <span class="pre">max_num_indices)</span></code>
Here, <code class="docutils literal notranslate"><span class="pre">max_num_indices</span></code> corresponds to the maximum number of indices over all samples.</p></li>
<li><p><strong>filler_value</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – Filler values for the remaining elements in the output (corresponding to the fillers in <code class="docutils literal notranslate"><span class="pre">input_indices</span></code>).
Default: 0.0</p></li>
<li><p><strong>dim_to_index_in</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Dimension on which to apply the indexing. Cannot be a batch dimension of the input indices.
If not set, will corresponds to <cite>input_indices.non_uniform_dim</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – Result containing the indexed entries from the input tensor. For a sample <code class="docutils literal notranslate"><span class="pre">i</span></code> and a valid
index <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">&lt;</span> <span class="pre">input_indices.sample_sizes[i]</span></code>, the following holds (assuming <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span> <span class="pre">==</span> <span class="pre">1</span></code>):
<code class="docutils literal notranslate"><span class="pre">indexed_vals[i,</span> <span class="pre">j]</span> <span class="pre">==</span> <span class="pre">input_data[i,</span> <span class="pre">input_indices[i,</span> <span class="pre">j]]</span></code></p>
<p>The shape of the resulting data is:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">indexed_vals.shape[0]</span> <span class="pre">==</span> <span class="pre">batch_size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indexed_vals.shape[dim_to_index_in]</span> <span class="pre">==</span> <span class="pre">max_num_indices</span></code></p></li>
<li><p>Remaining dimensions correspond to the input data</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘-’ indicates entries where the actual values are not relevant (in the input).</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
</ul>
</dd>
</dl>
<img alt="Illustration of the batched indexing operation" class="align-center" src="../../../_images/BatchedIndexing_ragged.png" />
<p>Each depicted entry in the data may represent a single value (in case of
2D tensors), or itself be a non-scalar entry (in case that <code class="docutils literal notranslate"><span class="pre">input_data</span></code> has more than 2 dimensions).</p>
<p>Note that for <code class="docutils literal notranslate"><span class="pre">input_indices</span></code>, the entries are always scalar.</p>
<p>Also, we do not show the <code class="docutils literal notranslate"><span class="pre">filler_value</span></code> in the example. It is filled into the ‘*’-entries in the output.</p>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code> is 1.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_indexing_write">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_indexing_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_write</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_write_into</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_to_index_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_indexing_ops.html#batched_indexing_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_indexing_write" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Batched indexing write, i.e. writing data into the indexed location, with non-uniform indices.</p>
<p>Non-uniform indices means that for each sample, the indices, as well as the number of indices, vary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is similar to <a class="reference internal" href="#accvlab.batching_helpers.batched_inverse_indexing_access" title="accvlab.batching_helpers.batched_inverse_indexing_access"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_inverse_indexing_access()</span></code></a>, but instead of creating a
constant tensor and filling the values in there, a <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code> tensor is used, which
may already contain values, and only the values corresponding to the indices are updated.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that whether <code class="docutils literal notranslate"><span class="pre">to_write</span></code> and <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code> are <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> or <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> instances, the indexing
is performed along <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code>, which is not necessarily the non-uniform dimension
of <code class="docutils literal notranslate"><span class="pre">to_write</span></code> or <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function assumes that for each sample, there are no duplicate indices in
<code class="docutils literal notranslate"><span class="pre">output_indices</span></code>, i.e. there are no duplicates in the valid entries in:
<code class="docutils literal notranslate"><span class="pre">output_indices[i,</span> <span class="pre">0:output_indices.sample_sizes[i]]</span></code>.</p>
<p>If this is not the case, the behavior is undefined.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_write</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Data which to write into the given indices.</p></li>
<li><p><strong>output_indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – For each sample (element along the batch dimension), the indices of entries to write to in the output.
Shape: <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">max_num_indices)</span></code>
Here, <code class="docutils literal notranslate"><span class="pre">max_num_indices</span></code> corresponds to the maximum number of indices over all samples.</p></li>
<li><p><strong>to_write_into</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Tensor or RaggedBatch to write into.</p></li>
<li><p><strong>dim_to_index_in</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Dimension on which to apply the indexing. Optional, default is the non-uniform
dimension of the output indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span> – Resulting tensor or <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance. Corresponds to <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code>, with the values from
<code class="docutils literal notranslate"><span class="pre">to_write</span></code> inserted at the corresponding indices, and the original values from <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code>
everywhere else.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘-’ indicates entries where the actual values are not relevant (in the input).</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
<li><p>‘..’ indicates data which remains unchanged, i.e. is the same as in the <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code> parameter
and the output.</p></li>
</ul>
</dd>
</dl>
<img alt="Illustration of the batched indexing write operation" class="align-center" src="../../../_images/BatchedIndexWrite_ragged.png" />
<p>Each depicted entry in the data may represent a single value (in case of
2D tensors), or itself be a non-scalar entry (in case that the data has more than 2 dimensions).</p>
<p>Note that for <code class="docutils literal notranslate"><span class="pre">output_indices</span></code>, the entries are always scalar.</p>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code> is 1.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.batched_inverse_indexing_access">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">batched_inverse_indexing_access</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_num_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filler_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_to_index_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_indexing_ops.html#batched_inverse_indexing_access"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.batched_inverse_indexing_access" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Batched setting of values at given indices, with non-uniform indices.</p>
<p>Non-uniform indices means that for each sample, the indices, as well as the number of indices, vary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is similar to <a class="reference internal" href="#accvlab.batching_helpers.batched_indexing_write" title="accvlab.batching_helpers.batched_indexing_write"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_indexing_write()</span></code></a>, but instead of using a <code class="docutils literal notranslate"><span class="pre">to_write_into</span></code>
tensor, a tensor with a uniform filler value is created first, and the values to set are
written into that tensor.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that whether <code class="docutils literal notranslate"><span class="pre">input_data</span></code> is a <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instance or a tensor, the indexing
is performed along <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code>, which is not necessarily the non-uniform dimension
of <code class="docutils literal notranslate"><span class="pre">input_data</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function assumes that for each sample, there are no duplicate indices in
<code class="docutils literal notranslate"><span class="pre">output_indices</span></code>, i.e. there are no duplicates in the valid entries in:
<code class="docutils literal notranslate"><span class="pre">output_indices[i,</span> <span class="pre">0:output_indices.sample_sizes[i]]</span></code>.</p>
<p>If this is not the case, the behavior is undefined.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Data which to write into the given indices.</p></li>
<li><p><strong>output_indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – For each sample (element along the batch dimension), the indices of entries to write to in the output.
Shape: <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">max_num_indices)</span></code>
Here, <code class="docutils literal notranslate"><span class="pre">max_num_indices</span></code> corresponds to the maximum number of indices over all samples.</p></li>
<li><p><strong>output_num_targets</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Size of the dimension corresponding to the indexed dimension in the output</p></li>
<li><p><strong>filler_value</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – Filler values for the non-indexed elements in the output. Default: 0.0</p></li>
<li><p><strong>dim_to_index_in</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Dimension on which to apply the indexing. Optional, default is the non-uniform
dimension of the output indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span> – Resulting tensor, containing the filled in values from the input, inserted at the corresponding indices,
and the filler values everywhere else.</p>
<p>For each sample <code class="docutils literal notranslate"><span class="pre">i</span></code> and each valid index <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">&lt;</span> <span class="pre">output_indices.sample_sizes[i]</span></code>, the following holds:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">output[i,</span> <span class="pre">output_indices[i,</span> <span class="pre">j]]</span> <span class="pre">==</span> <span class="pre">input_data[i,</span> <span class="pre">j]</span></code></p>
</div></blockquote>
<p>The shape of the resulting data is:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">output.shape[0]</span> <span class="pre">==</span> <span class="pre">batch_size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output.shape[dim_to_index_in]</span> <span class="pre">==</span> <span class="pre">output_nums_targets</span></code></p></li>
<li><p>Remaining dimensions correspond to the input data</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘-’ indicates entries where the actual values are not relevant (in the input).</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
</ul>
</dd>
</dl>
<img alt="Illustration of the batched inverse indexing operation" class="align-center" src="../../../_images/BatchedInverseIndexing_ragged.png" />
<p>Each depicted entry in the data may represent a single value (in case of
2D tensors), or itself be a non-scalar entry (in case that the data has more than 2 dimensions).</p>
<p>Note that for <code class="docutils literal notranslate"><span class="pre">output_indices</span></code>, the entries are always scalar.</p>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">dim_to_index_in</span></code> is 1.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.combine_data">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">combine_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_with_same_sample_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#combine_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.combine_data" title="Link to this definition"></a></dt>
<dd><p>Combine data given as an (optionally nested) sequence of tensors to a single RaggedBatch</p>
<p>Nested sequences can be processed in two different ways:</p>
<blockquote>
<div><ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">flatten_batch_dims</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the sequence is flattened as if it were a single sequence.
In this case, the result is a single RaggedBatch instance with a single batch dimension.
The sequence of the samples in the batch is ordered as they appear in <code class="docutils literal notranslate"><span class="pre">data_list</span></code> when
traversed in depth-first order. In this case, there are no requirements on the length
of the sequences in <cite>data_list</cite> on any nesting level and the number of elements in the
sequences can vary between individual elements and from one nesting level to the next.
Also, the number of nesting levels can vary between individual elements.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">flatten_batch_dims</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the sequence is treated as a nested sequence and the
nesting levels are preserved as batch dimensions, i.e. each nesting level corresponds
to one batch dimension. As the batching dimensions need to be of uniform size, the number
of elements in all lists for a given nesting level needs to be identical.</p>
<p>For example, the following needs to be fulfilled for the 2nd nesting level:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="o">...</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span>               <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="o">...</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span>               <span class="o">...</span>               <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="o">...</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of elements in the 1st nesting level and <code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of elements
in the 2nd nesting level.</p>
</li>
</ul>
</div></blockquote>
<p>The individual tensors contained in <code class="docutils literal notranslate"><span class="pre">data_list</span></code> need to match in size except for the dimension
<code class="docutils literal notranslate"><span class="pre">dim==0</span></code> (which will correspond to the non-uniform dimension in the resulting <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>
instance).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">other_with_same_sample_sizes</span></code> is provided, it is assumed that the batch shape and sample
sizes are identical. If this is not the case, the behavior is undefined.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>In the example below, the <a class="reference internal" href="#accvlab.batching_helpers.combine_data" title="accvlab.batching_helpers.combine_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_data()</span></code></a> operation is applied to a sequence of 4 tensors,
each corresponding to a single sample. As there is no nesting, a single batch dimension is created.
Note that in the image below:</p>
<blockquote>
<div><ul class="simple">
<li><p>Letters indicate data entries that are valid (i.e. correspond to the actual data).</p></li>
<li><p>‘*’ Indicates padded filler entries (i.e. invalid entries) in the data.</p></li>
</ul>
</div></blockquote>
<img alt="Illustration of the combine data operation" class="align-center" src="../../../_images/Combine_ragged.png" />
<p>Each depicted element may represent a single value (corresponding to scalar data and 0 data dimensions),
or itself represent a non-scalar entry (in case for one or more data dimensions).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_list</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</span>) – Sequence of tensors to combine.</p></li>
<li><p><strong>other_with_same_sample_sizes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Other RaggedBatch instance with the same batch size and sample sizes. This is
optional and if provided, the mask and sample sizes tensors are shared between
this RaggedBatch instance and the result, reducing the amount of needed memory.</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Device on which to create the resulting RaggedBatch. If not provided,
the device of the first element of <code class="docutils literal notranslate"><span class="pre">data_list</span></code> is used.</p></li>
<li><p><strong>flatten_batch_dims</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to flatten the batch dimensions (see discussion above for details). Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – The combined data.
Shape:</p>
<blockquote>
<div><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">flatten_batch_dims</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the batch dimension is <code class="docutils literal notranslate"><span class="pre">dim==0</span></code> and the non-uniform size dimension is <code class="docutils literal notranslate"><span class="pre">dim==1</span></code>.</p></li>
<li><dl class="simple">
<dt>If <code class="docutils literal notranslate"><span class="pre">flatten_batch_dims</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the batch dimensions correspond to the nesting levels</dt><dd><p>of <code class="docutils literal notranslate"><span class="pre">data_list</span></code>. The non-uniform size dimension is <code class="docutils literal notranslate"><span class="pre">dim==num_batch_dims</span></code> (i.e. the dimension
immediately following the batch dimensions).</p>
</dd>
</dl>
</li>
<li><p>The remaining dimensions are as in the input tensors.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.get_compact_from_named_tuple">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">get_compact_from_named_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#get_compact_from_named_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.get_compact_from_named_tuple" title="Link to this definition"></a></dt>
<dd><p>Get a compact version of all tensors (as <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances) in a named tuple as a new named tuple of the same type.</p>
<p>See <a class="reference internal" href="#accvlab.batching_helpers.get_compact_lists" title="accvlab.batching_helpers.get_compact_lists"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_compact_lists()</span></code></a> for details on compactification and an illustration of example inputs &amp; outputs.
This function works in the same way, but using named tuples instead of plain sequences as inputs &amp; outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Mask indicating which elements are valid (True) or not (False). Shape: (dim_size_0, dim_size_1)</p></li>
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></span>) – Named tuple containing tensors to be compactified. For each tensor, the shape is (dim_size_0, dim_size_1, …).
Note that different tensor in the list may have a different number of dimensions and a different size
except for the first 2 dimensions, which have to correspond to the mask. The tuple may contain elements
which are not tensors, and such elements will remain unchanged in the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></span> – Compact data, where elements containing tensors in the input are replaces by <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances,
while elements of other types remain unchanged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.get_compact_lists">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">get_compact_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#get_compact_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.get_compact_lists" title="Link to this definition"></a></dt>
<dd><p>For a list of data tensors and a mask indicating which entries are valid, get a compactified version of the data.</p>
<p>Compactification is performed along the second dimension (i.e. <code class="docutils literal notranslate"><span class="pre">dim==1</span></code>). Compactification in this context means that
for this dimension:</p>
<blockquote>
<div><ul class="simple">
<li><p>The size of the dimension is reduced so that it exactly fits the maximum number of valid elements over all samples,
i.e. the size of the dimension is <code class="docutils literal notranslate"><span class="pre">max(sum(mask,</span> <span class="pre">dim==1))</span></code>.</p></li>
<li><p>The data is converted to <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances for further processing (see documentation of
<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> for details of the format)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Mask indicating which elements are valid (True) and which are not (False).
Shape: (dim_size_0, dim_size_1)</p></li>
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – Sequence (e.g. <code class="docutils literal notranslate"><span class="pre">list</span></code>) of tensors to be compactified. For each tensor, the shape is
(dim_size_0, dim_size_1, …).
Note that different tensor in the sequence may have a different number of dimensions and a different size
except for the first 2 dimensions, which have to correspond to the mask. The sequence may contain elements
which are not tensors, and such elements will remain unchanged in the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span> – Compact data, where elements containing lists of tensors in the input are replaces by <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>
instances, while other elements remain unchanged.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<dl class="simple">
<dt>In the illustration below:</dt><dd><ul class="simple">
<li><p>Letters indicate data entries that are indexed in the input (and therefore appear in the output)</p></li>
<li><p>‘-’ indicates entries where the actual values are not relevant (in the input).</p></li>
<li><p>‘*’ indicates filler values in <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> instances.</p></li>
</ul>
</dd>
</dl>
<p>The illustration shows a single input entry <code class="docutils literal notranslate"><span class="pre">data[d]</span></code>, where <code class="docutils literal notranslate"><span class="pre">isinstance(data[d],</span> <span class="pre">torch.Tensor)</span> <span class="pre">==</span> <span class="pre">True</span></code>.
Note that for non-tensor elements of <code class="docutils literal notranslate"><span class="pre">data</span></code>, the data is not changed.</p>
<img alt="Illustration of the compactification operation" class="align-center" src="../../../_images/Compactification_ragged.png" />
<p>Each depicted element in the data may represent a single value (in case of 2D tensors),
or itself be a non-scalar entry (in case that the data has more than 2 dimensions).</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.get_indices_from_mask">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">get_indices_from_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#get_indices_from_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.get_indices_from_mask" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Get the indices from a mask.</p>
<p>For each sample, the indices correspond to the elements in the mask that are <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>This functionality is e.g. useful when boolean indexing needs to be applied multiple times for different
data and the same mask, as the indexing using numerical indices (using <a class="reference internal" href="#accvlab.batching_helpers.batched_indexing_access" title="accvlab.batching_helpers.batched_indexing_access"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_indexing_access()</span></code></a>) is
more efficient than boolean indexing (using <a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing" title="accvlab.batching_helpers.batched_bool_indexing"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_bool_indexing()</span></code></a>). Note that for a single
application of boolean indexing, the <a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing" title="accvlab.batching_helpers.batched_bool_indexing"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_bool_indexing()</span></code></a> function is more efficient.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 2D masks (batch_size, num_elements) are supported.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_mask_from_indices()</span></code> <a class="reference internal" href="#accvlab.batching_helpers.batched_indexing_access" title="accvlab.batching_helpers.batched_indexing_access"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_indexing_access()</span></code></a> <a class="reference internal" href="#accvlab.batching_helpers.batched_bool_indexing" title="accvlab.batching_helpers.batched_bool_indexing"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched_bool_indexing()</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>) – The mask to get the indices from.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span> – The indices from the mask.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>In the illustration below, ‘*’ indicates invalid indices, i.e. padding to make the tensor uniform for
samples where the number of indices is smaller than <code class="docutils literal notranslate"><span class="pre">max_num_indices</span></code>.</p>
<img alt="Illustration of the indices from mask operation" class="align-center" src="../../../_images/IndicesFromMask_ragged.png" />
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.get_mask_from_indices">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">get_mask_from_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_num_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_mask_from_indices.html#get_mask_from_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.get_mask_from_indices" title="Link to this definition"></a></dt>
<dd><div class="device-note docutils container">
<p>This function expects input data to be on the <strong>GPU</strong>.</p>
</div>
<p>Get a mask from indices, where the indices indicate which elements in the mask should be <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>The indices for each sample define the <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the mask for that sample
(i.e. the corresponding row in the mask).</p>
<dl class="simple">
<dt>For each sample <code class="docutils literal notranslate"><span class="pre">i</span></code>, the operation performed by this function is equivalent to:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mask[i,</span> <span class="pre">indices.tensor[i,</span> <span class="pre">:indices.sample_sizes[i]]]</span> <span class="pre">=</span> <span class="pre">True</span></code></p>
</dd>
</dl>
<p>Please also see the documentation of <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a> for more details on the format of the indices,
including the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> and <code class="docutils literal notranslate"><span class="pre">sample_sizes</span></code> attributes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is not the inverse of <a class="reference internal" href="#accvlab.batching_helpers.get_indices_from_mask" title="accvlab.batching_helpers.get_indices_from_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_indices_from_mask()</span></code></a>, as the index order is not
preserved when converting from indices to a mask.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_num_targets</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The number of targets in the mask, i.e. the <code class="docutils literal notranslate"><span class="pre">mask.shape[1]</span></code> to use</p></li>
<li><p><strong>indices</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – For each sample (element along the batch dimension), the indices of elements to set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Shape: (batch_size, max_num_indices)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(batch_size, <code class="docutils literal notranslate"><span class="pre">num_targets_in_mask</span></code>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resulting mask. Shape</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>In the illustration below, ‘*’ indicates invalid indices, i.e. padding to make the tensor uniform for
samples where the number of indices is smaller than <code class="docutils literal notranslate"><span class="pre">max_num_indices</span></code>. Note that the index order
does not matter for the resulting mask.</p>
<img alt="Illustration of the mask from indices operation" class="align-center" src="../../../_images/MaskFromIndices_ragged.png" />
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.squeeze_except_batch_and_sample">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">squeeze_except_batch_and_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#squeeze_except_batch_and_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.squeeze_except_batch_and_sample" title="Link to this definition"></a></dt>
<dd><p>Squeeze the data except the batch dimension and the non-uniform dimension representing the sample size.</p>
<p>For tensors, the batch dimension is always <code class="docutils literal notranslate"><span class="pre">dim==0</span></code>. The non-uniform dimensions is assumed to be
<code class="docutils literal notranslate"><span class="pre">dim==1</span></code>. For ragged batches, the batch dimensions are the first <code class="docutils literal notranslate"><span class="pre">data.num_batch_dims</span></code> dimensions and
the non-uniform dimension is the <code class="docutils literal notranslate"><span class="pre">data.non_uniform_dim</span></code> dimension.</p>
<p>This function is designed to preserve the batch and non-uniform dimensions, which have a special meaning,
while allowing to squeeze away other dimensions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that as a result of the squeezing, the non-uniform dimension may change to a different dimension.
This happens if there are any dimensions before the non-uniform dimension which are squeezed away.
For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 1, 1, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">num_batch_dims</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_squeezed</span> <span class="o">=</span> <span class="n">squeeze_except_batch_and_sample</span><span class="p">(</span><span class="n">example_batch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_squeezed</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 1, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_batch_squeezed</span><span class="o">.</span><span class="n">non_uniform_dim</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Note that the non-uniform dimension is now <code class="docutils literal notranslate"><span class="pre">dim==2</span></code> instead of <code class="docutils literal notranslate"><span class="pre">dim==3</span></code>. Also, as <code class="docutils literal notranslate"><span class="pre">dim==1</span></code> is
one of the batch dimensions, it is not squeezed away. The same would be true for
any other batch dimension or the non-uniform dimension.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span>) – Data to be squeezed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>]</span> – Squeezed data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="accvlab.batching_helpers.sum_over_targets">
<span class="sig-prename descclassname"><span class="pre">accvlab.batching_helpers.</span></span><span class="sig-name descname"><span class="pre">sum_over_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/accvlab/batching_helpers/batched_processing_py.html#sum_over_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#accvlab.batching_helpers.sum_over_targets" title="Link to this definition"></a></dt>
<dd><p>Sum over the non-uniform dimension, considering only the valid entries.</p>
<p>The dimension to average is <code class="docutils literal notranslate"><span class="pre">data.non_uniform_dim</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.data_format.ragged_batch.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a></span>) – Data to average</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span> – Tensor containing per-sample sums</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example.html" class="btn btn-neutral float-right" title="Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>