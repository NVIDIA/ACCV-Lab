

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; ACCV-Lab 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=9282052d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="Batching Helpers" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ACCV-Lab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../project_overview/README.html">ACCV-Lab Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides_index.html">Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contained Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../on_demand_video_decoder/docs/index.html">On Demand Video Decoder</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Batching Helpers</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dali_pipeline_framework/docs/index.html">DALI Pipeline Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../draw_heatmap/docs/index.html">Draw Heatmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim_test_tools/docs/index.html">Optimization Testing Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ACCV-Lab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Batching Helpers</a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/contained_package_docs_mirror/batching_helpers/docs/introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>The goal of the <cite>batching-helpers</cite> package is to enable an efficient and easy-to-use batching in case
of non-uniform batch sizes in order to speed up loss computation on the GPU. To achieve this, the
package defines a custom data type (<a class="reference internal" href="api.html#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>) and provides helper functions which
enable/simplify batched operations on the data.
In object detection and autonomous driving training tasks, a common challenge arises from non-uniform batch sizes.
This occurs because:</p>
<ol class="arabic simple">
<li><p>The number of ground truth (GT) objects varies per sample</p></li>
<li><p>While the number of predictions is typically fixed, not all predictions correspond to actual objects (e.g. some predictions are background)</p></li>
</ol>
<p>This non-uniformity affects:</p>
<ul class="simple">
<li><p>Ground truth data</p></li>
<li><p>Predictions used in loss computation (if e.g. only matched predictions are processed)</p></li>
<li><p>Correspondences between predictions and GT objects (e.g. index pairs linking predictions to GT objects)</p></li>
</ul>
<p>The <cite>batching-helpers</cite> package addresses these challenges through:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="api.html#accvlab.batching_helpers.RaggedBatch" title="accvlab.batching_helpers.RaggedBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedBatch</span></code></a>: An efficient data format for storing and processing non-uniform batches</p></li>
<li><p>Specialized operations for common loss computation tasks that are difficult to implement efficiently with standard PyTorch operators in a batched manner</p></li>
</ol>
<p>A key example of a specialized operation is selecting matched objects from both ground truth data and predictions based on index pairs established by the matching
algorithm. While PyTorch’s built-in indexing works well for single-sample processing, batch processing with varying indices and numbers of indices per sample
requires specialized handling. The package provides efficient helper functions for this and other common operations.</p>
<p>Note that some specialized operations are GPU-only (denoted as such in the API documentation), while others support both CPU and GPU execution.
As the goal of the package is to improve efficiency on the GPU through batching, many operations are implemented for the GPU only.
However, for some of the operations, a CPU implementation is provided. This includes operations which are potentially more efficient on the CPU (e.g. due to processing
of many small tensors, such as in the case of <a class="reference internal" href="api.html#accvlab.batching_helpers.combine_data" title="accvlab.batching_helpers.combine_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_data()</span></code></a>) or allow for more efficient CPU-GPU memory
transfers (e.g. by first performing <a class="reference internal" href="api.html#accvlab.batching_helpers.combine_data" title="accvlab.batching_helpers.combine_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_data()</span></code></a> on CPU tensors, followed by a transfer of the batch as a whole onto the GPU).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to the <a class="reference internal" href="api.html"><span class="doc">API Reference</span></a> for details on the provided functionality and the <a class="reference internal" href="example.html"><span class="doc">Example</span></a> for a
practical example and a short discussion about why using the approach implemented in this package leads to
performance gains.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Batching Helpers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>