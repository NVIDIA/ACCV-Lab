

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stopwatch Example &mdash; ACCV-Lab 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css?v=9282052d" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="NVTX Range Wrapper Example" href="nvtx_range_wrapper.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            ACCV-Lab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../project_overview/README.html">ACCV-Lab Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides_index.html">Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contained Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../on_demand_video_decoder/docs/index.html">On Demand Video Decoder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../batching_helpers/docs/index.html">Batching Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dali_pipeline_framework/docs/index.html">DALI Pipeline Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../draw_heatmap/docs/index.html">Draw Heatmap</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Optimization Testing Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Stopwatch Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#example-implementation">Example Implementation</a></li>
<li class="toctree-l5"><a class="reference internal" href="#resulting-output">Resulting Output</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#related-examples">Related examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nvtx_range_wrapper.html">NVTX Range Wrapper Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor_dumper_comparison.html">Tensor Dumper – Comparison Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor_dumper_dumping.html">Tensor Dumper – Extended Dumping Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">ACCV-Lab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Optimization Testing Tools</a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Stopwatch Example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/contained_package_docs_mirror/optim_test_tools/docs/examples/stopwatch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="stopwatch-example">
<h1>Stopwatch Example<a class="headerlink" href="#stopwatch-example" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<div class="docutils container">
<p>The stopwatch can be used to measure time for different steps in the implementation, across different parts of
the implementation. It supports warm-up handling and optional CPU usage measurement. It is a singleton, so you
can enable &amp; configure it once (e.g. in the main script) and then use it anywhere else assuming that it is
enabled/configured if needed.</p>
<dl>
<dt>Overview:</dt><dd><ul>
<li><p>The stopwatch is a singleton. Use <code class="docutils literal notranslate"><span class="pre">Stopwatch()</span></code> to retrieve the instance anywhere.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">enable(...)</span></code> once to activate measurements; otherwise calls become no-ops with minimal overhead.</p></li>
<li><p>You can measure repeated and one-time measurements across the code parts.</p></li>
<li><p>Fore repeated measurements, the name identifies the measurement (i.e. if the name is used multiple times,
this is considered multiple instances of the same measurement).</p></li>
<li><p>Repeated measurements are performed after a warm-up phase is finished; One-time measurements can be
performed at any time.</p></li>
<li><p>The stopwatch relies on tracking the number of finished iterations (for ending the warm-up phase,
computing average times per iteration, knowing when to print outputs). To ensure that this information is
correct, you need to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">finish_iter()</span></code> at the end of each iteration of the outer loop of interest
(e.g. training loop).</p></li>
<li><p>The output is printed in a formatted way with multiple sections. It contains the following information:</p>
<ul>
<li><p>For repeated measurements, multiple values are displayed:</p>
<blockquote>
<div><ul class="simple">
<li><p>Average runtime per measured interval (an interval is started by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">start_meas()</span></code> and ended
by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">end_meas()</span></code>)</p></li>
<li><p>Average iteration runtime (for the loop of interest). Here, if a measurement is performed multiple
times in a single iteration, it is accumulated for the result. Similarly, if a measurement is
performed in only some of the iterations, this will be reflected in the average iteration runtime
(e.g. if a measurement is performed every 2nd iteration, the average iteration runtime will be half
the average runtime per measured interval).</p></li>
<li><p>Total runtime</p></li>
<li><p>Mean CPU usage during the measurement which was selected (by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_cpu_usage_meas_name()</span></code>).</p></li>
</ul>
</div></blockquote>
</li>
<li><p>For one-time measurements</p>
<ul class="simple">
<li><p>Values are displayed in own section</p></li>
<li><p>Measurements are not influenced by the warm-up phase, and can be performed at any time.</p></li>
<li><p>A measurement with a given name can be performed only once.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</dd>
</dl>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The code of this example can be found in the repository under
<code class="docutils literal notranslate"><span class="pre">packages/optim_test_tools/examples/stopwatch_example.py</span></code>.</p>
</div>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<section id="example-implementation">
<h3>Example Implementation<a class="headerlink" href="#example-implementation" title="Link to this heading"></a></h3>
<p>Please see the notes in the code for more details.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">packages/optim_test_tools/examples/stopwatch_example.py</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1"># Copyright (c) 2025, NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved.</span>
<span class="linenos">  2</span><span class="c1">#</span>
<span class="linenos">  3</span><span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="linenos">  4</span><span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="linenos">  5</span><span class="c1"># You may obtain a copy of the License at</span>
<span class="linenos">  6</span><span class="c1">#</span>
<span class="linenos">  7</span><span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="linenos">  8</span><span class="c1">#</span>
<span class="linenos">  9</span><span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="linenos"> 10</span><span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="linenos"> 11</span><span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="linenos"> 12</span><span class="c1"># See the License for the specific language governing permissions and</span>
<span class="linenos"> 13</span><span class="c1"># limitations under the License.</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos"> 16</span><span class="sd">The stopwatch can be used to measure time for different steps in the implementation, across different parts of</span>
<span class="linenos"> 17</span><span class="sd">the implementation. It supports warm-up handling and optional CPU usage measurement. It is a singleton, so you</span>
<span class="linenos"> 18</span><span class="sd">can enable &amp; configure it once (e.g. in the main script) and then use it anywhere else assuming that it is</span>
<span class="linenos"> 19</span><span class="sd">enabled/configured if needed.</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span><span class="sd">Overview:</span>
<span class="linenos"> 22</span><span class="sd">  - The stopwatch is a singleton. Use ``Stopwatch()`` to retrieve the instance anywhere.</span>
<span class="linenos"> 23</span><span class="sd">  - Call ``enable(...)`` once to activate measurements; otherwise calls become no-ops with minimal overhead.</span>
<span class="linenos"> 24</span><span class="sd">  - You can measure repeated and one-time measurements across the code parts.</span>
<span class="linenos"> 25</span><span class="sd">  - Fore repeated measurements, the name identifies the measurement (i.e. if the name is used multiple times,</span>
<span class="linenos"> 26</span><span class="sd">    this is considered multiple instances of the same measurement).</span>
<span class="linenos"> 27</span><span class="sd">  - Repeated measurements are performed after a warm-up phase is finished; One-time measurements can be</span>
<span class="linenos"> 28</span><span class="sd">    performed at any time.</span>
<span class="linenos"> 29</span><span class="sd">  - The stopwatch relies on tracking the number of finished iterations (for ending the warm-up phase,</span>
<span class="linenos"> 30</span><span class="sd">    computing average times per iteration, knowing when to print outputs). To ensure that this information is</span>
<span class="linenos"> 31</span><span class="sd">    correct, you need to call :meth:`finish_iter` at the end of each iteration of the outer loop of interest</span>
<span class="linenos"> 32</span><span class="sd">    (e.g. training loop).</span>
<span class="linenos"> 33</span><span class="sd">  - The output is printed in a formatted way with multiple sections. It contains the following information:</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="sd">    - For repeated measurements, multiple values are displayed:</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="sd">        - Average runtime per measured interval (an interval is started by calling :meth:`start_meas` and ended</span>
<span class="linenos"> 38</span><span class="sd">          by calling :meth:`end_meas`)</span>
<span class="linenos"> 39</span><span class="sd">        - Average iteration runtime (for the loop of interest). Here, if a measurement is performed multiple</span>
<span class="linenos"> 40</span><span class="sd">          times in a single iteration, it is accumulated for the result. Similarly, if a measurement is</span>
<span class="linenos"> 41</span><span class="sd">          performed in only some of the iterations, this will be reflected in the average iteration runtime</span>
<span class="linenos"> 42</span><span class="sd">          (e.g. if a measurement is performed every 2nd iteration, the average iteration runtime will be half</span>
<span class="linenos"> 43</span><span class="sd">          the average runtime per measured interval).</span>
<span class="linenos"> 44</span><span class="sd">        - Total runtime</span>
<span class="linenos"> 45</span><span class="sd">        - Mean CPU usage during the measurement which was selected (by calling :meth:`set_cpu_usage_meas_name`).</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span><span class="sd">    - For one-time measurements</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span><span class="sd">      - Values are displayed in own section</span>
<span class="linenos"> 50</span><span class="sd">      - Measurements are not influenced by the warm-up phase, and can be performed at any time.</span>
<span class="linenos"> 51</span><span class="sd">      - A measurement with a given name can be performed only once.</span>
<span class="linenos"> 52</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="linenos"> 55</span><span class="kn">from</span><span class="w"> </span><span class="nn">accvlab.optim_test_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stopwatch</span>
<span class="linenos"> 56</span>
<span class="hll"><span class="linenos"> 57</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 58</span><span class="c1"># In this example, the individual sections (such as Main Script, Code Part I, Code Part II, etc.),</span>
</span><span class="hll"><span class="linenos"> 59</span><span class="c1"># indicate parts of the code which, in the actual use case, would be in different files, and would rely</span>
</span><span class="hll"><span class="linenos"> 60</span><span class="c1"># on the `Stopwatch` being a singleton to enable its use throughout the files as shown here.</span>
</span><span class="linenos"> 61</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="c1"># ---------------------------- Main Script ----------------------------</span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span><span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="hll"><span class="linenos"> 66</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 67</span><span class="c1"># To activate the stop watch, it needs to be enabled.</span>
</span><span class="hll"><span class="linenos"> 68</span><span class="c1"># If the following step is omitted, calls to method of the stopwatch will have no effect</span>
</span><span class="hll"><span class="linenos"> 69</span><span class="c1"># (and `get_num_nonwarmup_iters_measured()`) will always return `0``.</span>
</span><span class="hll"><span class="linenos"> 70</span><span class="c1"># Try commenting out the following line:</span>
</span><span class="linenos"> 71</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">num_warmup_iters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">print_every_n_iters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">do_cuda_sync</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="hll"><span class="linenos"> 72</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 73</span><span class="c1"># Note that if the stopwatch is not enabled, calling its methods has minimal overhead</span>
</span><span class="hll"><span class="linenos"> 74</span><span class="c1"># (call to an empty method).</span>
</span><span class="linenos"> 75</span>
<span class="linenos"> 76</span><span class="c1"># ---------------------------------------------------------------------</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="c1"># ---------------------------- Code Part I ----------------------------</span>
<span class="linenos"> 80</span>
<span class="hll"><span class="linenos"> 81</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 82</span><span class="c1"># Note that if a code part (such as this one) is used in isolation (meaning that there is no other code which</span>
</span><span class="hll"><span class="linenos"> 83</span><span class="c1"># already enabled the stopwatch), the stopwatch will be disabled and any related calls will have no effect.</span>
</span><span class="hll"><span class="linenos"> 84</span><span class="c1"># The overhead for the stopwatch is minimal in this case (call to an empty function).</span>
</span><span class="linenos"> 85</span>
<span class="hll"><span class="linenos"> 86</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 87</span><span class="c1"># Obtain the stopwatch instance (assuming that this is a separate file without access to the previously</span>
</span><span class="hll"><span class="linenos"> 88</span><span class="c1"># obtained one).</span>
</span><span class="linenos"> 89</span><span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="linenos"> 90</span>
<span class="hll"><span class="linenos"> 91</span><span class="c1"># @NOTE: Set up &quot;meas1&quot; to also measure mean CPU usage (can e.g. be the training loop in actual use case).</span>
</span><span class="linenos"> 92</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">set_cpu_usage_meas_name</span><span class="p">(</span><span class="s2">&quot;meas1&quot;</span><span class="p">)</span>
<span class="linenos"> 93</span>
<span class="hll"><span class="linenos"> 94</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos"> 95</span><span class="c1"># One-time measurements can be performed at any point in the code. They are not affected by warm-up</span>
</span><span class="hll"><span class="linenos"> 96</span><span class="c1"># iterations and can be performed only once per used name, and are reported as such</span>
</span><span class="hll"><span class="linenos"> 97</span><span class="c1"># (i.e. in own section and without averages etc.).</span>
</span><span class="linenos"> 98</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">start_one_time_measurement</span><span class="p">(</span><span class="s2">&quot;complete_run&quot;</span><span class="p">)</span>
<span class="linenos"> 99</span>
<span class="hll"><span class="linenos">100</span><span class="c1"># @NOTE: Another one-time measurement (start and end).</span>
</span><span class="linenos">101</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">start_one_time_measurement</span><span class="p">(</span><span class="s2">&quot;preparation&quot;</span><span class="p">)</span>
<span class="linenos">102</span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="linenos">103</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">end_one_time_measurement</span><span class="p">(</span><span class="s2">&quot;preparation&quot;</span><span class="p">)</span>
<span class="linenos">104</span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="n">num_iters</span> <span class="o">=</span> <span class="mi">16</span>
<span class="linenos">107</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iters</span><span class="p">):</span>
<span class="linenos">108</span>
<span class="linenos">109</span>    <span class="c1"># -------------------------- Code Part II --------------------------</span>
<span class="linenos">110</span>
<span class="hll"><span class="linenos">111</span>    <span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">112</span>    <span class="c1"># Obtain the stopwatch instance and use it to start a measurement (ended in another part of the code).</span>
</span><span class="linenos">113</span>    <span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="linenos">114</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">start_meas</span><span class="p">(</span><span class="s2">&quot;meas1&quot;</span><span class="p">)</span>
<span class="linenos">115</span>    <span class="c1"># Dummy workload to simulate some work.</span>
<span class="linenos">116</span>    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">117</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
<span class="linenos">118</span>        <span class="n">k</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="linenos">119</span>    <span class="c1"># ... continue and at some point call code part III</span>
<span class="linenos">120</span>
<span class="linenos">121</span>    <span class="c1"># ------------------------------------------------------------------</span>
<span class="linenos">122</span>
<span class="linenos">123</span>    <span class="c1"># -------------------------- Code Part III -------------------------</span>
<span class="linenos">124</span>
<span class="hll"><span class="linenos">125</span>    <span class="c1"># @NOTE: Here, we perform a measurement in another part of the code.</span>
</span><span class="linenos">126</span>    <span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="linenos">127</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">start_meas</span><span class="p">(</span><span class="s2">&quot;meas2&quot;</span><span class="p">)</span>
<span class="linenos">128</span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="linenos">129</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">end_meas</span><span class="p">(</span><span class="s2">&quot;meas2&quot;</span><span class="p">)</span>
<span class="linenos">130</span>    <span class="c1"># ... continue and at some point call code part IV</span>
<span class="linenos">131</span>
<span class="linenos">132</span>    <span class="c1"># ------------------------------------------------------------------</span>
<span class="linenos">133</span>
<span class="linenos">134</span>    <span class="c1"># ------------------------- Code Part IV  --------------------------</span>
<span class="linenos">135</span>
<span class="hll"><span class="linenos">136</span>    <span class="c1"># @NOTE: End the measurement started in part II.</span>
</span><span class="linenos">137</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">end_meas</span><span class="p">(</span><span class="s2">&quot;meas1&quot;</span><span class="p">)</span>
<span class="linenos">138</span>    <span class="c1"># ... continue and at some point call code part V</span>
<span class="linenos">139</span>
<span class="linenos">140</span>    <span class="c1"># ------------------------------------------------------------------</span>
<span class="linenos">141</span>
<span class="linenos">142</span>    <span class="c1"># --------------------------- Code Part V --------------------------</span>
<span class="linenos">143</span>
<span class="linenos">144</span>    <span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="hll"><span class="linenos">145</span>    <span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">146</span>    <span class="c1"># Measurements may also be performed in only some of the iterations. In this case,</span>
</span><span class="hll"><span class="linenos">147</span>    <span class="c1"># the average run-time per iteration will be lower than the average run-time</span>
</span><span class="hll"><span class="linenos">148</span>    <span class="c1"># per measured interval.</span>
</span><span class="linenos">149</span>    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">150</span>        <span class="n">stopwatch</span><span class="o">.</span><span class="n">start_meas</span><span class="p">(</span><span class="s2">&quot;meas3&quot;</span><span class="p">)</span>
<span class="linenos">151</span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="linenos">152</span>        <span class="n">stopwatch</span><span class="o">.</span><span class="n">end_meas</span><span class="p">(</span><span class="s2">&quot;meas3&quot;</span><span class="p">)</span>
<span class="hll"><span class="linenos">153</span>    <span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">154</span>    <span class="c1"># We can perform a measurement with the same name multiple times in a</span>
</span><span class="hll"><span class="linenos">155</span>    <span class="c1"># single iteration. This can be in the same or different code parts. In this case,</span>
</span><span class="hll"><span class="linenos">156</span>    <span class="c1"># the average run-time per iteration will be higher than the average run-time</span>
</span><span class="hll"><span class="linenos">157</span>    <span class="c1"># per measured interval.</span>
</span><span class="linenos">158</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">start_meas</span><span class="p">(</span><span class="s2">&quot;meas2&quot;</span><span class="p">)</span>
<span class="linenos">159</span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="linenos">160</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">end_meas</span><span class="p">(</span><span class="s2">&quot;meas2&quot;</span><span class="p">)</span>
<span class="linenos">161</span>    <span class="c1"># ... continue and at some point call code part VI</span>
<span class="linenos">162</span>
<span class="linenos">163</span>    <span class="c1"># ------------------------------------------------------------------</span>
<span class="linenos">164</span>
<span class="linenos">165</span>    <span class="c1"># -------------------------- Code Part VI ---------------------------</span>
<span class="linenos">166</span>
<span class="hll"><span class="linenos">167</span>    <span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">168</span>    <span class="c1"># Finish the iteration. This is very important to</span>
</span><span class="hll"><span class="linenos">169</span>    <span class="c1">#   - Ensure that the warm-up iterations are counted down correctly and measurements are</span>
</span><span class="hll"><span class="linenos">170</span>    <span class="c1">#     started after the warm-up iterations.</span>
</span><span class="hll"><span class="linenos">171</span>    <span class="c1">#   - Ensure that the measurements are correctly accumulated and printed.</span>
</span><span class="linenos">172</span>    <span class="n">stopwatch</span> <span class="o">=</span> <span class="n">Stopwatch</span><span class="p">()</span>
<span class="linenos">173</span>    <span class="n">stopwatch</span><span class="o">.</span><span class="n">finish_iter</span><span class="p">()</span>
<span class="linenos">174</span>
<span class="linenos">175</span>    <span class="c1"># ------------------------------------------------------------------</span>
<span class="linenos">176</span>
<span class="linenos">177</span>
<span class="linenos">178</span><span class="c1"># ---------------------------- Code Part VI ----------------------------</span>
<span class="linenos">179</span>
<span class="hll"><span class="linenos">180</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">181</span><span class="c1"># End the one-time measurement</span>
</span><span class="linenos">182</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">end_one_time_measurement</span><span class="p">(</span><span class="s2">&quot;complete_run&quot;</span><span class="p">)</span>
<span class="hll"><span class="linenos">183</span><span class="c1"># @NOTE</span>
</span><span class="hll"><span class="linenos">184</span><span class="c1"># Print the final result</span>
</span><span class="linenos">185</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final measurement:&quot;</span><span class="p">)</span>
<span class="linenos">186</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">print_eval_times</span><span class="p">()</span>
<span class="linenos">187</span>
<span class="linenos">188</span><span class="c1"># ----------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
</section>
<section id="resulting-output">
<h3>Resulting Output<a class="headerlink" href="#resulting-output" title="Link to this heading"></a></h3>
<p>Here, we show an example output for the last time that the stopwatch was used to print the results. Note
that the actual result will vary depending on the actual runtime of the code parts. Note that for
<code class="docutils literal notranslate"><span class="pre">meas2</span></code> and <code class="docutils literal notranslate"><span class="pre">meas3</span></code>, the average runtime per iteration is different from the average runtime per measured
interval. This is because these measurements were performed multiple times per iteration / only in some
of the iterations, respectively.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>######################### Stopwatch #########################
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Num. measured iterations: 11
. . . . . . . . . . . . . . . . . . . . . . . . .
Average runtime per iteration:
  `meas1`: 0.16802375966852362
  `meas2`: 0.060098127885298294
  `meas3`: 0.0036563439802689986
. . . . . . . . . . . . . . . . . . . . . . . . .
Average runtime per measured interval:
  `meas1`: 0.16802375966852362
  `meas2`: 0.030049063942649147
  `meas3`: 0.010054945945739746
. . . . . . . . . . . . . . . . . . . . . . . . .
Total runtime:
  `meas1`: 1.8482613563537598
  `meas2`: 0.6610794067382812
  `meas3`: 0.040219783782958984
. . . . . . . . . . . . . . . . . . . . . . . . .
Mean CPU usage during `meas1`: 2.655618891226586
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
One-time measurements:
  `complete_run`: 3.0058188438415527
  `preparation`: 0.10008645057678223
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#############################################################
</pre></div>
</div>
</section>
</section>
<section id="related-examples">
<h2>Related examples<a class="headerlink" href="#related-examples" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>See the <a class="reference internal" href="nvtx_range_wrapper.html"><span class="doc">NVTX Range Wrapper Example</span></a> example for a similar singleton pattern applied to NVTX ranges.</p></li>
<li><p>The tensor dumper examples (<a class="reference internal" href="tensor_dumper_comparison.html"><span class="doc">Tensor Dumper – Comparison Example</span></a> and <a class="reference internal" href="tensor_dumper_dumping.html"><span class="doc">Tensor Dumper – Extended Dumping Example</span></a>) also follow
the singleton pattern and can be enabled once and used across multiple code parts.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nvtx_range_wrapper.html" class="btn btn-neutral float-right" title="NVTX Range Wrapper Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>